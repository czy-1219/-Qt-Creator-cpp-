软件开发环境说明书
ddcar2\build\Desktop_Qt_6_10_1_MinGW_64_bit-Debug，理论上这个文件路径下的ddcar2应用程序无需编译器就能打开
操作：直接点击主界面的司机端选择账号（无密码效验），在网格地图上选择司机的初始位置，再点击右上角的上线按钮，司机才能接受派单
然后乘客端同理登录，直接再地图上选择起点和终点，点击叫车，所有在线的司机中其上线位置距离乘客起点最近的会派单，司机端选择接受/拒单，如果接单后司机会移动到起点，再次点击开始行程才会向终点移动，到终点后点击结束行程后会显示价钱



适用软件：基于 Qt 6.10.1 的 C++ 项目
一、开发环境总览
本软件基于 Qt + C++ 技术栈开发，采用 CMake 作为构建工具，适配 Windows 64 位操作系统，核心编译环境为 MSVC 2022，构建模式分为Debug和Release两种。
二、核心软件版本及环境要求
2.1 操作系统
类型为 Windows 11，要求启用 64 位架构支持。
其他系统不知道是否适用，没有测试除了windows的其他操作系统
2.2 核心开发软件版本
Qt 需使用 6.10.1 版本（msvc2022_64），作为核心开发框架（一般只要在qt6.10的安装工具安装对应的组件就能运行整个文件夹），提供 UI、QML、跨平台等能力，必须为 MSVC 2022 64 位编译版本；VS 需使用 2022 版本（需要安装拓展），提供 MSVC 2022 64 位编译器，需安装 “Desktop development with C++” 组件；CMake 版本需≥3.20，作为项目构建工具，需支持 CMake Presets v3 版本（3.20 及以上）；Ninja 需使用最新稳定版，作为高效构建器，替代传统 Make 工具，Qt Creator 默认集成，也可手动配置环境变量；
Qt Creator 为可选工具，需使用适配 Qt 6.10.1 的版本，是推荐的IDE，可自动识别 CMake Presets 配置，简化开发流程。
2.3 Qt 安装路径要求
Qt 6.10.1 需安装至指定路径，路径为 C:/Qt/6.10.1/msvc2022_64，若修改路径，需同步更新 CMake 配置。
三、CMake 构建配置说明
项目通过 CMake Presets（版本 3）预设构建参数，无需手动配置编译环境，核心配置如下：
3.1 预设结构（继承关系）
构建预设的继承关系为：Qt（Qt 工具链内置基础预设）下方继承 6.10.1_msvc2022_64（隐藏预设，定义 Qt 路径、架构及构建器），后者再继承 Qt-Default（隐藏预设，封装通用 Qt 配置），最终衍生出 Qt-Debug（调试模式）和 Qt-Release（发布模式）两个可直接使用的预设。
3.2 调试模式（Qt-Debug）
输出目录为源码根目录 /out/build/debug，核心参数包括：构建类型为 Debug（保留调试符号，无编译优化）；启用 QML 调试，添加 - DQT_QML_DEBUG 编译宏，支持 QML 断点调试；调试参数为阻塞等待 QML 调试器附加，便于开发阶段排查问题。
3.3 发布模式（Qt-Release）
输出目录为源码根目录 /out/build/release，核心参数包括：构建类型为 Release（无调试符号，开启全编译优化）；产物特性为体积小、运行效率高，适用于最终发布。
四、角色分配
开发时便于调试，没有设置密码与账号。
 一、核心业务逻辑模块
1. dispatchsystem.cpp
   
   - 实现订单调度系统，采用单例模式设计
   - 负责司机注册与管理、订单分配算法
   - 基于距离优先原则匹配司机（50公里范围内）
   - 处理司机拒绝订单、订单状态变化等事件
   - 维护在线司机列表和可用订单列表
2. ordermanager.cpp
   
   - 实现订单管理系统，采用单例模式设计
   - 负责订单的创建、状态更新、取消和完成
   - 生成唯一订单号（时间戳+随机数）
   - 计算订单预估费用、距离和时间
   - 根据车型（普通车/专车）调整费用和时间
   - 支持按状态、乘客、司机查询订单
3. mapdata.cpp
   
   - 实现地图数据管理，采用单例模式设计
   - 生成网格地图（默认50x50网格）
   - 维护节点、边和邻接表数据结构
   - 提供距离计算（曼哈顿距离）
   - 实现地图节点的查找和坐标转换
4. pathplanner.cpp
   
   - 实现路径规划功能，采用单例模式设计
   - 基于网格的路径规划算法（先X轴后Y轴）
   - 提供路径平滑功能（移除共线点）
   - 实现A*算法的启发式函数（曼哈顿距离）
   - 支持路径重建功能
5. order.cpp
   
   - 实现订单类，包含订单的完整生命周期
   - 定义订单状态枚举（Pending、Accepted、OnTheWay等）
   - 管理订单相关数据（乘客、司机、位置、费用等）
   - 提供订单状态变化的信号通知 二、用户管理模块
6. user.cpp
   
   - 实现用户基类，定义用户的基本属性和状态
   - 包含用户ID、姓名、手机号等基本信息
   - 定义用户状态枚举（Online、Offline等）
   - 为Passenger和Driver类提供继承基础
7. passenger.cpp
   
   - 实现乘客类，继承自User
   - 提供下单和取消订单功能
   - 发送订单请求信号
   - 管理乘客的订单历史
8. driver.cpp
   
   - 实现司机类，继承自User
   - 管理司机的车辆信息（车牌号、车型）
   - 处理接单、拒单、开始行程、结束行程等操作
   - 维护司机的位置信息和在线状态
   - 记录司机的完成订单数和累计里程 三、UI界面模块
9. mainwindow.cpp
   
   - 实现主窗口，程序的入口界面
   - 提供乘客登录、司机登录、平台登录入口
   - 实现用户注册功能
   - 管理用户数据的加载和保存（JSON格式）
   - 初始化地图数据
   - 清理活跃订单和资源
10. passengerwindow.cpp
    
    - 实现乘客界面
    - 提供地图交互功能，允许乘客选择起点和终点
    - 展示订单状态和行程信息
    - 支持订单的创建和取消
    - 显示司机位置和预计到达时间
11. driverwindow.cpp
    
    - 实现司机界面
    - 展示司机的当前位置和状态
    - 处理订单推送和接单操作
    - 显示行程路线和乘客信息
    - 支持行程开始、暂停和结束操作
12. platformwindow.cpp
    
    - 实现平台管理界面
    - 提供系统监控功能
    - 展示订单统计和司机状态
    - 支持订单的手动干预和管理
    - 提供系统参数配置功能 四、辅助功能模块
13. workerthread.cpp
    
    - 实现工作线程类
    - 用于处理耗时的后台任务
    - 避免阻塞UI线程，提高系统响应性
    - 支持线程间通信
14. main.cpp
    
    - 程序入口文件
    - 初始化Qt应用程序
    - 创建并显示主窗口
    - 启动事件循环
### 系统核心流程
1. 用户登录/注册 ：通过MainWindow进入相应角色界面
2. 乘客下单 ：在PassengerWindow选择起点终点，创建订单
3. 订单创建 ：OrderManager生成订单，计算预估费用
4. 订单调度 ：DispatchSystem匹配合适司机
5. 司机接单 ：DriverWindow接收订单推送，司机选择接单
6. 行程开始 ：司机到达乘客位置，开始行程
7. 行程结束 ：到达目的地，结束行程，计算费用
8. 订单完成 ：OrderManager更新订单状态为Completed
### 技术特点
1. 基于Qt框架 ：使用信号槽机制实现对象间通信
2. 单例模式 ：核心服务类（DispatchSystem、OrderManager等）采用单例设计
3. 网格地图 ：简化的地图模型，便于路径规划和距离计算
4. 模块化设计 ：清晰的模块划分，便于维护和扩展
5. JSON数据持久化 ：用户数据和订单数据使用JSON格式存储
### 系统架构
- UI层 ：各Window类，负责用户交互
- 业务逻辑层 ：DispatchSystem、OrderManager等，负责核心业务处理
- 数据层 ：MapData、用户数据等，负责数据管理
- 通信机制 ：Qt信号槽，实现模块间松耦合通信
